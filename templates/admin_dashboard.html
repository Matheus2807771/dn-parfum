<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Admin - Amakha Paris</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Segoe UI',Arial,sans-serif;background:#0b1022;color:#fff;min-height:100vh}
.header{background:#141937;padding:15px 30px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #2b3055}
.header h1{font-size:20px;color:#23c483}
.header-links a{color:#888;text-decoration:none;margin-left:20px}
.header-links a:hover{color:#23c483}
.container{max-width:1400px;margin:auto;padding:30px}

/* Tabs */
.tabs{display:flex;gap:10px;margin-bottom:30px}
.tab-btn{padding:12px 24px;background:#141937;border:2px solid #2b3055;border-radius:10px;color:#fff;cursor:pointer}
.tab-btn.active{background:#23c483;color:#000;border-color:#23c483}

/* Conteúdo */
.tab-content{display:none}
.tab-content.active{display:block}

/* Cards */
.card{background:#141937;border-radius:15px;padding:25px;margin-bottom:20px}
.chart-wrapper{height:320px}

/* Tabelas */
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid #2b3055;text-align:left;vertical-align:top}
th{color:#23c483}

/* Botões */
.btn{padding:8px 14px;border-radius:8px;border:none;cursor:pointer;font-weight:bold}
.btn-primary{background:#23c483;color:#000}
.btn-danger{background:#ff4444;color:#fff}
.btn-secondary{background:#2b3055;color:#fff}
.btn-warning{background:#ffaa00;color:#000}
.btn-sm{padding:6px 10px;font-size:13px}

/* Form */
.form-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-top:12px}
.field{display:flex;flex-direction:column;gap:6px}
.field label{font-size:13px;color:#9aa3c7}
.field input,.field select, .field textarea{
  padding:10px;border-radius:10px;border:1px solid #2b3055;background:#0b1022;color:#fff
}
.field textarea{min-height:90px;resize:vertical}
.actions-row{display:flex;gap:10px;align-items:center;margin-top:12px;flex-wrap:wrap}
.inline-input{padding:8px;border-radius:8px;border:1px solid #2b3055;background:#0b1022;color:#fff}

/* Badges */
.badge{display:inline-block;padding:4px 10px;border-radius:999px;font-size:12px}
.badge-on{background:#23c483;color:#000}
.badge-off{background:#2b3055;color:#fff}

/* ===== RANKING ===== */
.ranking-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:16px;
  margin-top:16px;
}
.ranking-card{
  background:linear-gradient(145deg,#141937,#0b1022);
  border:1px solid #2b3055;
  border-radius:14px;
  padding:16px;
}
.ranking-pos{color:#23c483;font-weight:700;font-size:13px;margin-bottom:6px}
.ranking-nome{font-size:15px;font-weight:600}
.ranking-qtd{font-size:13px;color:#9aa3c7;margin-top:4px}

/* ===== MODAL ENTREGA ===== */
.modal-backdrop{
  display:none;
  position:fixed; inset:0;
  background:rgba(0,0,0,.65);
  z-index:999;
  align-items:center;
  justify-content:center;
  padding:18px;
}
.modal{
  width:100%;
  max-width:820px;
  background:#141937;
  border:1px solid #2b3055;
  border-radius:16px;
  padding:18px;
}
.modal-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:12px;
}
.modal-title{font-size:18px;color:#23c483;font-weight:700}
.modal-close{
  background:#2b3055;color:#fff;border:none;border-radius:10px;
  padding:8px 12px;cursor:pointer;font-weight:700
}
.modal-grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:12px;
}
.modal-grid .field{margin-top:0}
.modal-footer{
  display:flex;
  gap:10px;
  justify-content:flex-end;
  margin-top:14px;
  flex-wrap:wrap;
}
.small-muted{color:#9aa3c7;font-size:12px}
</style>
</head>

<body>

<div class="header">
  <h1>Painel Administrativo - Amakha Paris</h1>
  <div class="header-links">
    <a href="/" target="_blank">Ver Site</a>
    <a href="/admin/logout">Sair</a>
  </div>
</div>

<div class="container">

<div class="tabs">
  <button class="tab-btn active" onclick="showTab('relatorios',this)">Relatórios</button>
  <button class="tab-btn" onclick="showTab('kits',this)">Kits</button>
  <button class="tab-btn" onclick="showTab('perfumes',this)">Perfumes</button>
  <button class="tab-btn" onclick="showTab('config',this)">Configurações</button>
</div>

<div id="tab-relatorios" class="tab-content active">

  <div class="form-grid">
    <div class="card">
      <h4>Hoje</h4>
      <b id="stat-valor-hoje">R$ 0,00</b><br>
      <small>Pedidos: <b id="stat-pedidos-hoje">0</b></small>
    </div>
    <div class="card">
      <h4>Mês</h4>
      <b id="stat-valor-mes">R$ 0,00</b><br>
      <small>Pedidos: <b id="stat-pedidos-mes">0</b></small>
    </div>
    <div class="card">
      <h4>Total</h4>
      <b id="stat-valor-total">R$ 0,00</b>
    </div>
    <div class="card">
      <h4>Total de Pedidos</h4>
      <b id="stat-total-pedidos">0</b>
    </div>
  </div>

  <div class="card">
    <h3>Vendas por Período (últimos 30 dias)</h3>
    <div class="chart-wrapper">
      <canvas id="chartVendas"></canvas>
    </div>
  </div>

  <div class="card">
    <h3>Perfumes Mais Vendidos</h3>
    <div id="ranking-perfumes" class="ranking-grid"></div>

    <h3 style="margin-top:28px">Kits Mais Vendidos</h3>
    <div id="ranking-kits" class="ranking-grid"></div>
  </div>

  <div class="card">
    <h3>Pedidos Recentes</h3>
    <table>
      <thead>
        <tr>
          <th>ID</th><th>Data</th><th>Kit</th><th>Cliente</th>
          <th>Whats</th><th>Endereço</th><th>Valor</th><th>Status</th><th>Ações</th>
        </tr>
      </thead>
      <tbody id="lista-pedidos"></tbody>
    </table>
    <div class="small-muted" style="margin-top:10px">
      Entrega é definida no Admin (modal “Entrega”). O site não calcula frete.
    </div>
  </div>

</div>

<div id="tab-kits" class="tab-content">
  <div class="card">
    <h2>Kits</h2>
    <div class="form-grid">
      <div class="field">
        <label>Quantidade</label>
        <input id="kit-qtd">
      </div>
      <div class="field">
        <label>Preço</label>
        <input id="kit-preco">
      </div>
      <div class="field" style="grid-column:span 2">
        <label>&nbsp;</label>
        <button class="btn btn-primary" onclick="criarKit()">Adicionar Kit</button>
      </div>
    </div>

    <div class="actions-row">
      <button class="btn btn-secondary btn-sm" onclick="carregarKits()">Recarregar</button>
      <span id="kits-status"></span>
    </div>

    <table>
      <thead>
        <tr><th>Qtd</th><th>Preço</th><th>Status</th><th>Ações</th></tr>
      </thead>
      <tbody id="kits-tbody"></tbody>
    </table>
  </div>
</div>

<div id="tab-perfumes" class="tab-content">
  <div class="card">
    <h2>Perfumes</h2>
    <div class="form-grid">
      <div class="field">
        <label>Nome</label>
        <input id="p-nome">
      </div>
      <div class="field">
        <label>Categoria</label>
        <select id="p-cat">
          <option>Masculino</option>
          <option>Feminino</option>
          <option>Infantil</option>
        </select>
      </div>
      <div class="field">
        <label>ML</label>
        <select id="p-ml">
          <option>15ml</option>
          <option>30ml</option>
          <option>50ml</option>
        </select>
      </div>
      <div class="field">
        <label>&nbsp;</label>
        <button class="btn btn-primary" onclick="criarPerfume()">Adicionar</button>
      </div>
    </div>

    <table>
      <thead>
        <tr><th>Nome</th><th>Categoria</th><th>ML</th><th>Status</th><th>Ações</th></tr>
      </thead>
      <tbody id="perfumes-tbody"></tbody>
    </table>
  </div>
</div>

<div id="tab-config" class="tab-content">
  <div class="card">
    <h2>Configurações</h2>
    <div class="form-grid">
      <div class="field">
        <label>WhatsApp</label>
        <input id="cfg-whats">
      </div>
      <div class="field">
        <label>CEP Origem</label>
        <input id="cfg-cep">
      </div>
      <div class="field">
        <label>Nova Senha</label>
        <input id="cfg-senha" type="password">
      </div>
      <div class="field">
        <label>&nbsp;</label>
        <button class="btn btn-primary" onclick="salvarConfig()">Salvar</button>
      </div>
    </div>
    <span id="cfg-status"></span>
  </div>
</div>

</div>

<!-- MODAL ENTREGA -->
<div id="modalEntregaBackdrop" class="modal-backdrop">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title" id="modalEntregaTitle">Entrega</div>
      <button class="modal-close" onclick="fecharModalEntrega()">Fechar</button>
    </div>

    <div class="modal-grid">
      <div class="field">
        <label>Transportadora / Tipo</label>
        <input id="entrega_tipo" placeholder="Ex: Correios PAC / Motoboy / Retirada">
      </div>
      <div class="field">
        <label>Valor do frete (R$)</label>
        <input id="entrega_valor" type="number" step="0.01" placeholder="0.00">
      </div>
      <div class="field" style="grid-column:span 2">
        <label>Observação</label>
        <textarea id="entrega_obs" placeholder="Ex: postar amanhã; prazo 4-6 dias; combinar horário"></textarea>
      </div>
      <div class="field" style="grid-column:span 2">
        <label>Status após salvar</label>
        <select id="entrega_status">
          <option value="">(não alterar)</option>
          <option value="pendente">pendente</option>
          <option value="confirmado">confirmado</option>
          <option value="cancelado">cancelado</option>
        </select>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="fecharModalEntrega()">Cancelar</button>
      <button class="btn btn-primary" onclick="salvarEntregaModal()">Salvar Entrega</button>
    </div>

    <div class="small-muted" id="entrega_msg" style="margin-top:10px"></div>
  </div>
</div>

<script src="/static/admin/relatorios.js"></script>
<script src="/static/admin/kits.js"></script>
<script src="/static/admin/perfumes.js"></script>
<script src="/static/admin/config.js"></script>
<script src="/static/admin/core.js"></script>

</body>
</html>
